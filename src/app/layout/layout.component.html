<div class="shell">
  <header class="appbar">
    <div class="left-space">
      <div class="logo">
        <img src="assets/logo.png" alt="Logo" />
      </div>
    </div>

    <nav class="menu-container" role="navigation" aria-label="Principal">
      <!-- Izquierda -->
      <a
        *ngFor="let m of leftMenu"
        [routerLink]="m.path"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
        class="btn btn-sm"
        >{{ m.label }}</a
      >

      <!-- Derecha -->
      <a
        *ngFor="let m of rightMenu"
        [routerLink]="m.path"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
        class="btn btn-sm"
        >{{ m.label }}</a
      >
    </nav>

    <!-- Usuario centrado -->
    <div class="user-slot" #userMenu>
      <button
        class="user-chip"
        (click)="toggleUserMenu()"
        aria-haspopup="menu"
        [attr.aria-expanded]="isMenuOpen"
      >
        <span class="name">{{ username }}</span>
        <span class="role">{{ currentRole }}</span>
        <span class="caret">▾</span>
      </button>

      <div class="dropdown" *ngIf="isMenuOpen" role="menu">
        <div class="dropdown-title">Cambiar a</div>
        <button
          class="drop-item"
          *ngFor="let r of roles"
          (click)="selectRole(r)"
          role="menuitem"
        >
          {{ r }}
        </button>
        <div class="divider"></div>
        <button class="drop-item danger" (click)="signOut()" role="menuitem">
          Cerrar sesión
        </button>
      </div>
    </div>

    <div class="right-space">
      <button class="mode-toggle" (click)="toggleMode()">
        {{ modeAscii }}
      </button>
    </div>
  </header>

  <main class="page-content">
    <router-outlet></router-outlet>
  </main>
</div>
